{% extends 'base.html' %}
{% load static %}

{% block title %}Lecturer Login - Digital Attendance System{% endblock %}

{% block extra_css %}
<style>
    /* Use the site's card styles and small helpers so login matches the theme */
    .login-hero {
        min-height: calc(100vh - 220px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-2xl) 0;
    }

    .card {
        max-width: 480px;
        margin: 0 auto;
    }

    .card-header {
        background: linear-gradient(135deg, var(--primary-light) 0%, #f8fbff 100%);
        border-bottom: 1px solid var(--neutral-border);
        padding: var(--spacing-lg);
    }

    .card-header h3 {
        color: var(--primary-dark);
        margin-bottom: 0.25rem;
    }

    .card-header p { color: var(--text-secondary); margin: 0; }

    .login-icon {
        width: 64px;
        height: 64px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 0.5rem;
        background: var(--primary-color);
        color: var(--text-inverse);
        font-size: 1.25rem;
    }

    /* Slight entrance animation */
    .card { transform: translateY(4px); transition: transform 220ms ease, box-shadow 220ms ease; }
    .card:hover { transform: translateY(0); box-shadow: var(--shadow-md); }

    /* Keep the password toggle visually consistent with the theme */
    .input-group .form-control {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .input-group .btn-outline-secondary {
        background-color: var(--secondary-light);
        border-color: var(--neutral-border);
        color: var(--text-primary);
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        transition: background-color 0.15s ease, color 0.15s ease;
    }

    .input-group .btn-outline-secondary:focus { box-shadow: 0 0 0 0.15rem rgba(37, 99, 235, 0.08); }

    /* eye icon animation */
    #togglePassword i { transition: transform 180ms ease, color 120ms ease; }
    #togglePassword.toggled i { transform: rotateX(180deg); color: var(--primary-color); }

    @media (max-width: 480px) {
        .login-hero { padding: var(--spacing-lg) 0 }
        .card { border-radius: var(--radius-sm); }
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function(){
    const toggleBtn = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');
    // restore previous visibility preference
    try{
        const saved = localStorage.getItem('login_show_password');
        if(saved === 'true' && passwordInput){
            passwordInput.setAttribute('type','text');
            toggleBtn && toggleBtn.classList.add('toggled');
            toggleBtn && toggleBtn.querySelector('i') && toggleBtn.querySelector('i').classList.remove('fa-eye');
            toggleBtn && toggleBtn.querySelector('i') && toggleBtn.querySelector('i').classList.add('fa-eye-slash');
        }
    }catch(e){}

    if(toggleBtn && passwordInput){
        toggleBtn.addEventListener('click', function(e){
            e.preventDefault();
            const icon = this.querySelector('i');
            const isPassword = passwordInput.getAttribute('type') === 'password';
            passwordInput.setAttribute('type', isPassword ? 'text' : 'password');
            icon.classList.toggle('fa-eye');
            icon.classList.toggle('fa-eye-slash');
            this.classList.toggle('toggled', isPassword);
            this.setAttribute('aria-pressed', isPassword);
            try{ localStorage.setItem('login_show_password', isPassword); }catch(e){}
        });
    }
});
</script>
{% endblock %}

{% block content %}
<div class="login-hero">
    <div class="container container-sm">
        <div class="card">
            <div class="card-header text-center">
                <div class="login-icon mx-auto mb-3"><i class="fas fa-sign-in-alt"></i></div>
                <h3 class="mb-0">Welcome Back</h3>
                <p class="mb-0 text-muted">Sign in to your lecturer account</p>
            </div>

            <div class="card-body">
                {% if messages %}
                    {% for message in messages %}
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        {{ message }}
                    </div>
                    {% endfor %}
                {% endif %}

                <form method="POST" action="{% url 'login' %}">
                    {% csrf_token %}

                    <div class="form-group">
                        <label for="username" class="form-label required">Username</label>
                        <input type="text" id="username" name="username" class="form-control" placeholder="Enter your username" required autofocus>
                    </div>

                    <div class="form-group">
                        <label for="password" class="form-label required">Password</label>
                        <div class="input-group">
                            <input type="password" id="password" name="password" class="form-control" placeholder="Enter your password" required>
                            <button class="btn btn-outline-secondary" id="togglePassword" type="button" aria-label="Toggle password visibility" aria-pressed="false">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-check mb-3">
                        <input type="checkbox" id="remember" name="remember" class="form-check-input">
                        <label for="remember" class="form-check-label">Remember me</label>
                    </div>

                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-arrow-right me-2"></i>Sign In
                    </button>
                </form>
            </div>

            <div class="card-footer text-center text-muted">
                Don't have an account? Contact the system administrator
            </div>
        </div>
    </div>
</div>
{% endblock %}
